name: Sync to Hugging Face Hub

on:
  push:
    branches: [main, dev]

jobs:
  sync-to-hub:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: true

      - name: Push to Hub
        env:
          HF_TOKEN: ${{ github.ref == 'refs/heads/main' && secrets.ACCESS_TOKEN_HUGGING_PRD || secrets.ACCESS_TOKEN_HUGGING_DEV }}
          SPACE_NAME: ${{ github.ref == 'refs/heads/main' && 'joaobarreto27/prd_youth_event_registration_app' || 'joaobarreto27/dev_youth_event_registration_app' }}
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"

          git remote add space "https://joaobarreto27:$HF_TOKEN@huggingface.co/spaces/$SPACE_NAME"

          git push space HEAD:main -f
